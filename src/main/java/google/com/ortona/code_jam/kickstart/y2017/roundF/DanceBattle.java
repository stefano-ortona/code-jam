package google.com.ortona.code_jam.kickstart.y2017.roundF;

import java.util.List;

import com.google.common.collect.Lists;

public class DanceBattle {

  public int solve(int energy, List<Integer> opponents) {
    int maxHonour = 0;
    int curHonour = 0;
    while (!opponents.isEmpty()) {
      // get the weakest
      final int weakest = getWeakestOpponent(opponents);
      if (opponents.get(weakest) < energy) {
        // defeat it
        curHonour++;
        // update the max honour if it has increased
        maxHonour = Math.max(curHonour, maxHonour);
        // System.out.println("Defeat " + opponents.get(weakest));
        energy -= opponents.get(weakest);
        opponents.remove(weakest);
      } else {
        // if my honour is 0, I cannot do anything else since I cannot ally with anyone
        if (curHonour == 0) {
          return maxHonour;
        } else {
          // ally with the strongest
          final int strongest = getStrongestOpponent(opponents);
          energy += opponents.get(strongest);
          // System.out.println("Ally " + opponents.get(strongest));
          opponents.remove(strongest);
          curHonour--;
        }
      }
    }
    return maxHonour;
  }

  private int getWeakestOpponent(List<Integer> opponents) {
    int weakest = opponents.get(0);
    int index = 0;
    for (int i = 1; i < opponents.size(); i++) {
      if (opponents.get(i) < weakest) {
        weakest = opponents.get(i);
        index = i;
      }
    }
    return index;
  }

  private int getStrongestOpponent(List<Integer> opponents) {
    int strongest = opponents.get(0);
    int index = 0;
    for (int i = 1; i < opponents.size(); i++) {
      if (opponents.get(i) > strongest) {
        strongest = opponents.get(i);
        index = i;
      }
    }
    return index;
  }

  public static void main(String[] args) {
    final int energy = 332726;
    final List<Integer> opponents = Lists.newArrayList(374, 1106, 2195, 2259, 2384, 4507, 4915, 5305, 5523, 6033, 6065,
        6568, 6748, 6927, 8919, 9141, 9919, 13909, 14166, 14771, 14874, 14972, 15754, 17203, 17503, 18565, 19639, 19718,
        20174, 21319, 21588, 21654, 21943, 22644, 24266, 25351, 25802, 26647, 27703, 27928, 27966, 28303, 29169, 29467,
        29823, 32523, 32768, 33806, 34267, 34410, 34648, 34962, 36084, 37098, 37794, 39779, 46642, 46967, 47278, 48030,
        48581, 50798, 53503, 54089, 54392, 54903, 58674, 59967, 61303, 62705, 62778, 63979, 64483, 65169, 65897, 66264,
        67243, 67623, 68143, 68626, 68671, 69287, 71515, 71923, 72587, 73217, 75195, 76365, 76577, 76683, 78556, 79988,
        82080, 84010, 84392, 85305, 86563, 86840, 87197, 87443, 88648, 89088, 90609, 90982, 91345, 91879, 95631, 96590,
        97702, 99686, 99693, 101887, 102966, 103317, 104758, 105588, 105693, 106115, 106692, 106858, 107067, 107639,
        107973, 108181, 108678, 111038, 111062, 111868, 111958, 112703, 115753, 117918, 118773, 119740, 120830, 122492,
        123002, 123341, 123941, 125610, 125723, 126035, 126114, 126906, 127501, 129153, 129839, 130288, 130476, 130493,
        130826, 133619, 134245, 137160, 137964, 139131, 139287, 139349, 140430, 142621, 143687, 144419, 144820, 145261,
        147273, 147394, 148117, 148537, 151539, 153764, 158609, 159701, 161378, 161566, 162638, 163836, 163925, 164010,
        166805, 167201, 169124, 169273, 169807, 170678, 172122, 173563, 175671, 176129, 176687, 177865, 179149, 180138,
        181774, 182909, 183173, 183180, 184028, 184126, 184931, 189624, 190017, 190442, 192001, 192635, 193427, 194754,
        195763, 196170, 196625, 196829, 197841, 198749, 199823, 200838, 201276, 202004, 202888, 205808, 206908, 207551,
        210925, 211042, 211383, 217661, 217930, 218030, 218200, 218393, 221851, 222661, 222687, 224677, 224793, 225023,
        226062, 226546, 227158, 230449, 230811, 231590, 231854, 232832, 233788, 233943, 235915, 237178, 237367, 238052,
        239264, 240591, 240619, 240950, 245705, 250713, 251680, 251738, 252576, 254722, 255871, 257195, 257234, 258389,
        262013, 262951, 263222, 263883, 264112, 264366, 264393, 266843, 266974, 267348, 267482, 267555, 269153, 270948,
        271874, 273335, 274153, 274293, 275058, 276279, 277083, 277293, 279029, 281697, 282138, 282453, 283071, 283198,
        283438, 286844, 288493, 289427, 289860, 290005, 290379, 291028, 291297, 291517, 291818, 292014, 293959, 295139,
        295268, 296170, 296711, 297269, 297678, 298473, 298786, 299337, 300218, 300573, 300616, 303461, 303513, 304015,
        306338, 307029, 308717, 308889, 309730, 312462, 313875, 315229, 315514, 316109, 316459, 317368, 317720, 319142,
        319442, 321509, 323235, 323418, 323688, 325601, 326101, 326271, 326451, 326874, 327088, 327942, 329287, 329958,
        331341, 331533, 331605, 331693, 333301, 333302, 333978, 334941, 335340, 337590, 337633, 338250, 341293, 341648,
        343594, 344726, 345458, 346556, 347308, 348142, 348238, 349514, 349708, 349923, 352021, 355491, 356093, 357589,
        358670, 359460, 360658, 360690, 361201, 361970, 362605, 362974, 364104, 366531, 369047, 369660, 369844, 372175,
        373207, 373649, 373986, 375142, 375746, 376757, 377629, 378107, 379970, 380908, 381373, 382644, 382889, 383170,
        383385, 383447, 383926, 384369, 384680, 385313, 385368, 385472, 387258, 388465, 388898, 389452, 390731, 391029,
        391367, 391432, 391521, 391854, 392665, 393512, 393785, 393988, 394079, 395955, 396671, 397265, 399110, 399478,
        399580, 400698, 400978, 401840, 402237, 402259, 402546, 404730, 405732, 407234, 408725, 410297, 413139, 413288,
        413425, 413795, 414261, 415438, 417859, 417933, 418722, 418735, 420592, 421534, 422141, 422389, 423188, 425995,
        427335, 427813, 429978, 430404, 431445, 431479, 431703, 431845, 432507, 432678, 433613, 434707, 435659, 435715,
        436629, 436788, 438061, 438467, 439392, 440284, 442007, 442578, 442644, 443762, 448382, 448931, 451216, 451387,
        452550, 454094, 454136, 454786, 456745, 457404, 459875, 460087, 460685, 461876, 465800, 466114, 466589, 468324,
        469307, 469913, 470768, 471152, 474870, 476071, 476174, 477328, 480392, 482063, 482650, 482658, 484151, 485300,
        485340, 486051, 487127, 487388, 487828, 489961, 490062, 490196, 492520, 493752, 493870, 494033, 495298, 496722,
        501011, 502788, 502986, 504346, 505661, 506724, 507043, 507384, 514808, 515485, 516110, 516528, 517432, 517960,
        518158, 518708, 519082, 522028, 522677, 523580, 524002, 524451, 526138, 530325, 530605, 531161, 531772, 532171,
        534796, 536457, 536860, 537059, 539759, 541330, 541744, 541873, 541934, 542565, 543112, 546633, 546973, 547528,
        547769, 548020, 548489, 550037, 551105, 552896, 552923, 553539, 556437, 557136, 558401, 559790, 564647, 565126,
        565570, 565776, 566073, 567393, 568148, 568711, 569255, 569430, 569748, 571439, 573834, 576782, 579645, 580025,
        581414, 581856, 581989, 584394, 585171, 586328, 587320, 587566, 589662, 589759, 590961, 591303, 595990, 597118,
        597493, 598163, 599793, 600116, 601059, 601094, 601155, 602172, 602548, 604414, 604782, 607169, 607811, 608048,
        609551, 612593, 612943, 613352, 613514, 615207, 616871, 619026, 620471, 621687, 626504, 626611, 626837, 627435,
        629314, 630349, 630815, 630894, 632089, 632154, 635347, 635727, 637064, 638211, 639649, 640030, 644176, 645459,
        646270, 646597, 648204, 648317, 651382, 653064, 654091, 654244, 655758, 656749, 657392, 658905, 659701, 659810,
        660052, 660137, 661270, 663045, 663157, 664937, 666498, 666545, 668239, 668630, 668818, 669650, 670499, 670761,
        671240, 673399, 673488, 675270, 675519, 677550, 678232, 678419, 680094, 680186, 681083, 684067, 684942, 686709,
        688547, 689770, 690098, 690387, 690567, 691459, 691787, 692859, 693472, 694389, 694923, 696261, 696392, 696527,
        696750, 697541, 698141, 705542, 707396, 708113, 713479, 713734, 714263, 714652, 715042, 715661, 716282, 716901,
        717925, 718037, 718559, 718908, 720309, 723035, 723841, 724226, 725243, 725422, 728066, 728458, 729617, 730253,
        730451, 731354, 733600, 733756, 735313, 735831, 736590, 739135, 739163, 741049, 741196, 742605, 742671, 743418,
        743760, 743878, 744164, 744363, 745014, 745347, 745976, 746075, 746465, 747549, 749662, 750181, 750640, 751667,
        753152, 753341, 753613, 753871, 755513, 756025, 757346, 757419, 757744, 758554, 758780, 759890, 761614, 762545,
        762632, 762892, 763034, 763137, 764987, 767166, 768279, 769914, 770069, 771456, 771658, 772255, 773951, 774621,
        775013, 776066, 776710, 777558, 778525, 781460, 783241, 784338, 785330, 786325, 789660, 790112, 791234, 791833,
        792975, 793758, 795248, 796309, 796871, 797552, 799105, 799791, 801651, 801655, 801926, 801953, 802332, 803158,
        803856, 804516, 807465, 807824, 807931, 808245, 808613, 809276, 809661, 810018, 818508, 819999, 820890, 822151,
        822198, 823626, 823938, 825397, 826249, 828795, 829107, 829136, 829757, 830751, 831330, 831464, 831905, 834359,
        835205, 835554, 837199, 838654, 840274, 841190, 841364, 841835, 846543, 847283, 847737, 848267, 848311, 849015,
        850512, 850889, 851637, 851769, 852196, 855707, 856500, 856956, 858768, 858950, 860769, 862060, 863829, 867973,
        869532, 870760, 871214, 873906, 874116, 874454, 874839, 875734, 876182, 876407, 876899, 881980, 882820, 883428,
        883458, 884940, 889016, 889111, 889982, 890784, 890982, 891106, 893856, 895348, 896408, 896745, 897712, 897890,
        898852, 899440, 899943, 900081, 900491, 901542, 901979, 905230, 905837, 906303, 907941, 909056, 909762, 910751,
        911245, 912455, 913277, 913510, 917144, 917829, 920510, 921380, 921726, 923472, 923627, 923826, 924692, 926833,
        928330, 928821, 929779, 932120, 932687, 934201, 934381, 934405, 935546, 937210, 938813, 939994, 940049, 940818,
        941139, 943347, 944615, 945028, 945481, 947335, 948372, 948574, 949301, 949809, 949959, 950591, 954581, 955555,
        957406, 958681, 959077, 959664, 959830, 961220, 963721, 964718, 964909, 965139, 965512, 966072, 969113, 970657,
        971762, 972592, 972592, 972771, 974383, 974866, 975561, 976443, 977620, 979007, 979501, 980582, 982402, 983303,
        985994, 986491, 990608, 991042, 992033, 994345, 994738, 996806, 996809, 997383);
    final DanceBattle dance = new DanceBattle();
    System.out.println(dance.solve(energy, opponents));
  }

}
